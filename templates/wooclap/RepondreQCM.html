{% extends 'partials/base.html' %}

{% block head %}
<script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.0.1/socket.io.js"></script>
<script>
    const socket = io();
    socket.on('connect', function() {
        socket.emit('testRQ', "Je suis dans repondre au question");
    });
    var code;
    var questions;
    var reponses;
    socket.on('receptionDonnees',(dcode,dquestions,dreponses) => {
        code=dcode;
        questions=dquestions.slice(1,dquestions.length-1).split(", ");
        reponses=dreponses.slice(1,dreponses.length-1).split(", ");
    });
    socket.on('afficheQuestion',(data) => {
        console.log(data)
        $("#enonce").text(questions[data]);
        if (reponses[data]==undefined){
            $("#reponse").append('<p><input type="text" pattern="\d*([.]\d{0,2})?"></p>');
        }else{
            reponses[data].forEach((r) => {
                $("#reponse").append(r);
            });
        }
    });
</script>
{% endblock %}

{% block main %}
<div class="menu">
    <h1 id="enonce"></h1>
    <form action="{{ url_for('repondreQCM', i=i)}}" method="POST">
        <div id="reponses">

        </div>
    </form>
</div>

<!-- Le goat a dit : "c'est statique donc impossible (+arguments)" et le goat a toujours raison -->

<!-- <div class="menu">
    <form action="{{ url_for('repondreQCM', i=i)}}" method="POST">
        <div class="Reponse_etudiant">
            {%if lena != 0%}
                <p class="Reponse_etudiant" id="{{ListeQuestionsQcm[i].idQ}}">{{ListeQuestionsQcm[i].enonce}}</p>
                <input type="hidden" value={{ListeQuestionsQcm[i].enonce}} name="question">
                {%for key in ListeReponseQcm[i] %} 
                    {%if key.estNumerique%}
                        <p><input type="text" pattern="\d*([.]\d{0,2})?" id="{{key.idR}}" name="reponse_num"></p>
                    {%else%}
                        <p><input type="checkbox" id="{{key.idR}}" name="reponse_choix" value="{{key.idR}}" /> {{key.reponse}}</p>
                    {%endif%} 
                {%endfor%} 
                {%if i== lena%}
                    <button>Fin</button> 
                {%else%}
                    <button>Prochain question</button> 
                {%endif%} 
            {%else%}
                <p>Il n'y a rien ici pour le moment</p>
            {%endif%}
        </div>
    </form>
</div> -->
{% endblock %}